I"™S<h2 id="ë¸Œë¼ìš°ì €ì—ì„œ-ì…ì¶œë ¥-ì œì–´">ë¸Œë¼ìš°ì €ì—ì„œ ì…ì¶œë ¥ ì œì–´</h2>

<p>í˜„ì¬ ë§Œë“¤ê³  ìˆëŠ” í”„ë¡œì œê¸‘ëŠ” ë””ìŠ¤ì½”ë“œì™€ ê²Œë”íƒ€ìš´ê³¼ ìœ ì‚¬í•œ, ì‹¤ì‹œê°„ í†µì‹ ì´ ë“¤ì–´ê°„ ì›¹ í”Œë«í¼ì´ë‹¤. ì´ëŸ° ìœ ì‚¬í•œ í”„ë¡œì íŠ¸ì— í•„ìˆ˜ì ìœ¼ë¡œ ë“¤ì–´ê°€ì•¼ ë˜ëŠ” ìš”ì†ŒëŠ” ì˜¤ë””ì˜¤ì˜ ì œì–´ì´ë‹¤.</p>

<blockquote>
  <p>ë§ì„ í•˜ë‹¤ê°€ ë§ˆì´í¬ë¥¼ ë°”ê¿”ì•¼ ë˜ëŠ” ìƒí™©ì´ ëœë‹¤ë©´?</p>
</blockquote>

<blockquote>
  <p>ìŒì§ˆì´ ì¢‹ì§€ ì•Šë‹¤ê³  í•´ì„œ, ì´ì–´í°ì„ ê¼ˆì„ ë•Œ, ì†Œë¦¬ë¥¼ ìŠ¤í”¼ì»¤ì—ì„œ ì´ì–´í°ì„ ë°”ê¿”ì•¼ í•œë‹¤ë©´?</p>
</blockquote>

<blockquote>
  <p>ì´ì–´í° ë°°í„°ë¦¬ê°€ ë‚˜ê°€ì„œ ì¤‘ê°„ì— ìŠ¤í”¼ì»¤ë¡œ êµì²´ í•´ì•¼ëœë‹¤ë©´?</p>
</blockquote>

<p>ë“± ë“± ì •ë§ ë§ì€ ìƒí™©ë“¤ì´ ì—°ì¶œ ë  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  ê°€ì¥ ê°„í¸í•œ ë°©ë²•ì€, ì•Œì•„ì„œ ì‹œìŠ¤í…œì˜ Defaultì¥ë¹„ë¥¼ êµì²´ í›„ ë¸Œë¼ìš°ì €ë¥¼ refresh í•´ë²„ë¦¬ë©´ ëœë‹¤.
í•˜ì§€ë§Œ UX ê´€ì ì—ì„œ, ì˜¤ë””ì˜¤ì˜ ì…ì¶œë ¥ì„ ë¸Œë¼ìš°ì €ì—ì„œ í•˜ëŠ”ê±´ ì¤‘ìš”í•˜ë‹¤. ì‚¬ì‹¤, ì›¹ í”Œë«í¼ì´ ì•„ë‹Œ electronì²˜ëŸ¼ ì•±ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤ë©´ ì‰¬ì› ê² ì§€ë§Œâ€¦</p>

<p>ê·¸ë ‡ê²Œ ë¸Œë¼ìš°ì € ì˜¤ë””ì˜¤ ì…ì¶œë ¥ ì œì–´ì— ëŒ€í•œ ê¸€ì„ ì°¾ì•„ë³´ë˜ ì¤‘ ì •ë§ ì‰½ê²Œ ì •ë¦¬ëœ ê¸€ë„ ì—†ê³ , ì˜¤ë˜ëœ ë‚´ìš©ë“¤ íŠ¹íˆ ì´ë¯¸ ì§€ì›ì´ ëë‚œ í•¨ìˆ˜ë“¤ì´ ë§ì•„ ë§‰ ì‚¬ìš©í•˜ê¸° ì •ë§ ì‰½ì§€ ì•Šì•˜ë‹¤. ê·¸ë˜ì„œ ë‚´ê°€ í•œë²ˆ ì •ë¦¬ë¥¼ í•´ë³´ì•˜ë‹¤.</p>

<h4 id="ì œê³µí• -ê¸°ëŠ¥-ëª©ë¡">ì œê³µí•  ê¸°ëŠ¥ ëª©ë¡</h4>

<ol>
  <li>ì¹´ë©”ë¼ ì…ë ¥ ë””ë°”ì´ìŠ¤ ì œì–´ê°€ëŠ¥</li>
  <li>ìŒì„± ì…ë ¥ ë””ë°”ì´ìŠ¤ ì œì–´ê°€ëŠ¥</li>
  <li>ìŒì„± ì¶œë ¥ ë””ë°”ì´ìŠ¤ ì œì–´ê°€ëŠ¥</li>
</ol>

<p>ë“œëë‹¤ìš´ ê¹Œì§€ ì™„ì„±ëœ í˜•íƒœëŠ” <a href="https://velog.io/@071yoon/%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%93%9C%EB%9E%8D%EB%8B%A4%EC%9A%B4-%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EC%9E%90">ì°¸ê³ </a>ë§í¬ì— ìˆë‹¤.</p>

<h3 id="ì…ì¶œë ¥-ë””ë°”ì´ìŠ¤-ì°¾ê¸°">ì…ì¶œë ¥ ë””ë°”ì´ìŠ¤ ì°¾ê¸°</h3>

<p>ìš°ì„ , ì„ íƒì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ë‚˜ì˜ ì…ì¶œë ¥ ë””ë°”ì´ìŠ¤ë¥¼ ì°¾ëŠ”ê²ƒ ë¶€í„° í•´ì•¼ëœë‹¤.</p>

<p>ëª¨ë“  ì„ íƒ ë° ì œì–´ëŠ” ë“œëë‹¤ìš´ì—ì„œ ë Œë”ë§ì—ë„ ì‚¬ìš©ë˜ë¯€ë¡œ ì „ë¶€ ìƒíƒœë¡œ ê´€ë¦¬í•´ì£¼ì—ˆë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Selectors.tsx</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nf">Selectors</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">audioInput</span><span class="p">,</span> <span class="nx">setAudioInput</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">MediaDeviceInfo</span><span class="p">[]</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span><span class="p">([]);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">audioOutput</span><span class="p">,</span> <span class="nx">setAudioOutput</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">MediaDeviceInfo</span><span class="p">[]</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span><span class="p">([]);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">videoInput</span><span class="p">,</span> <span class="nx">setVideoInput</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="o">&lt;</span><span class="nx">MediaDeviceInfo</span><span class="p">[]</span> <span class="o">|</span> <span class="kc">null</span><span class="o">&gt;</span><span class="p">([]);</span>
  <span class="nf">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nf">getDevice</span><span class="p">(</span><span class="nx">setAudioInput</span><span class="p">,</span> <span class="nx">setAudioOutput</span><span class="p">,</span> <span class="nx">setVideoInput</span><span class="p">);</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return </span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Container</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">SelectorContainer</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Selector</span> <span class="nx">select</span><span class="o">=</span><span class="dl">"</span><span class="s2">camera</span><span class="dl">"</span> <span class="nx">device</span><span class="o">=</span><span class="p">{</span><span class="nx">videoInput</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Selector</span> <span class="nx">select</span><span class="o">=</span><span class="dl">"</span><span class="s2">mic</span><span class="dl">"</span> <span class="nx">device</span><span class="o">=</span><span class="p">{</span><span class="nx">audioInput</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">Selector</span> <span class="nx">select</span><span class="o">=</span><span class="dl">"</span><span class="s2">speaker</span><span class="dl">"</span> <span class="nx">device</span><span class="o">=</span><span class="p">{</span><span class="nx">audioOutput</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/SelectorContainer</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/Container</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ê·¸ë¦¬ê³  getDeviceí•¨ìˆ˜ì—ì„œ í˜„ì¬ ì‚¬ìš©í•˜ê³  ìˆëŠ” ëª¨ë“  ì¥ë¹„ë“¤ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” <code class="language-plaintext highlighter-rouge">navigator.mediaDevices.enumerateDevices()</code>í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">console</code>ì„ ì°ì–´ë³´ë©´ ë‚˜ì˜¨ deviceì˜ ë¦¬ìŠ¤íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
<img width="985" alt="image" src="https://user-images.githubusercontent.com/66371206/188820065-c76d2d54-9e2a-4031-867f-1c3853347934.png" /></p>

<p>ì—¬ê¸°ì„œ <code class="language-plaintext highlighter-rouge">kind</code>ë¡œ ë¶„ë¥˜í•˜ì—¬ ë¹„ë””ì˜¤ ì…ë ¥, ì˜¤ë””ì˜¤ ì…ë ¥, ì˜¤ë””ì˜¤ ì¶œë ¥ì„ êµ¬ë³„í•˜ì—¬ ë”°ë¡œ ì €ì¥í•˜ì˜€ë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// getDevice.ts</span>
<span class="kd">const</span> <span class="nx">getDevice</span> <span class="o">=</span> <span class="k">async </span><span class="p">(</span>
  <span class="nx">setAudioInput</span><span class="p">:</span> <span class="nx">Dispatch</span><span class="o">&lt;</span><span class="nx">SetStateAction</span><span class="o">&lt;</span><span class="nx">MediaDeviceInfo</span><span class="p">[]</span><span class="o">&gt;&gt;</span><span class="p">,</span>
  <span class="nx">setAudioOutput</span><span class="p">:</span> <span class="nx">Dispatch</span><span class="o">&lt;</span><span class="nx">SetStateAction</span><span class="o">&lt;</span><span class="nx">MediaDeviceInfo</span><span class="p">[]</span><span class="o">&gt;&gt;</span><span class="p">,</span>
  <span class="nx">setVideoInput</span><span class="p">:</span> <span class="nx">Dispatch</span><span class="o">&lt;</span><span class="nx">SetStateAction</span><span class="o">&lt;</span><span class="nx">MediaDeviceInfo</span><span class="p">[]</span><span class="o">&gt;&gt;</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">devices</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">mediaDevices</span><span class="p">.</span><span class="nf">enumerateDevices</span><span class="p">();</span>
    <span class="nf">setAudioInput</span><span class="p">(</span><span class="nx">devices</span><span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">device</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">device</span><span class="p">.</span><span class="nx">kind</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">audioinput</span><span class="dl">"</span><span class="p">));</span>
    <span class="nf">setAudioOutput</span><span class="p">(</span><span class="nx">devices</span><span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">device</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">device</span><span class="p">.</span><span class="nx">kind</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">audiooutput</span><span class="dl">"</span><span class="p">));</span>
    <span class="nf">setVideoInput</span><span class="p">(</span><span class="nx">devices</span><span class="p">.</span><span class="nf">filter</span><span class="p">((</span><span class="nx">device</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">device</span><span class="p">.</span><span class="nx">kind</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">videoinput</span><span class="dl">"</span><span class="p">));</span>
    <span class="k">return</span> <span class="nx">devices</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="dl">"</span><span class="s2">error getting devices</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">return</span> <span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ ì£¼ë¥´ë¥µ ë‚˜ì˜¨ devicesë“¤ì„ ê°€ì§€ê³  ì €ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œ ë‹¤ë¤˜ë˜ ë“œëë‹¤ìš´ì„ í†µí•˜ì—¬ ìœ ì €ê°€ ì„ íƒí•œ ë””ë°”ì´ìŠ¤ ì •ë³´ë¥¼ ë‚˜ì˜ ìƒíƒœì— ì €ì¥ë  ìˆ˜ ìˆê²Œ ì„¤ì •í•´ì£¼ì—ˆë‹¤.</p>

<blockquote>
  <p><a href="https://velog.io/@071yoon/%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%93%9C%EB%9E%8D%EB%8B%A4%EC%9A%B4-%EC%95%A0%EB%8B%88%EB%A9%94%EC%9D%B4%EC%85%98%EC%9D%84-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B3%B4%EC%9E%90">ì €ë²ˆ ë¸”ë¡œê·¸ ì£¼ì†Œ</a></p>
</blockquote>

<h3 id="ì¶œë ¥-ë””ë°”ì´ìŠ¤-ì œì–´">ì¶œë ¥ ë””ë°”ì´ìŠ¤ ì œì–´</h3>

<p>ë¬´ì‚¬íˆ ìœ ì €ê°€ ì›í•˜ëŠ” ì…ì¶œë ¥ ë””ë°”ì´ìŠ¤ë¥¼ ì„ íƒí•˜ì˜€ê³ , ê·¸ ì •ë³´ê°€ <code class="language-plaintext highlighter-rouge">userAudioOutputDevice</code>ë¼ëŠ” ìƒíƒœì— ì¡´ì¬í•œë‹¤ê³  ê°€ì •í•˜ê³  ì§„í–‰í•˜ë„ë¡ í•˜ê² ë‹¤.</p>

<p>ì‚¬ì‹¤ ì—¬ê¸°ê¹Œì§€ ì™”ë‹¤ë©´ ê±°ì˜ ë‹¤í•œê²ƒì´ë‚˜ ë§ˆì°¬ê°€ì§€ë‹¤. ì ì–´ë„ ì¶œë ¥ì€ ì •ë§ ê°„ë‹¨í•˜ë‹¤.</p>

<p>í˜„ì¬ ìš°ë¦¬ì˜ í”Œë«í¼ì—ì„œ ì§€ì›í•˜ëŠ” ì˜¤ë””ì˜¤ ì¶œë ¥ì€ ë‘ê°€ì§€ ì¡´ì¬í•œë‹¤.</p>

<ol>
  <li>í…Œë§ˆ bgm</li>
  <li>ìƒëŒ€ë°©ì˜ ë§ˆì´í¬ ìŒì„±</li>
</ol>

<p>ìš°ì„  ìƒëŒ€ë°©ì˜ ë§ˆì´í¬ ìŒì„±ì„ ì œì–´í•˜ëŠ” ë¶€ë¶„ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Screen.tsx</span>
<span class="nf">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">videoRef</span><span class="p">.</span><span class="nx">current</span> <span class="o">&amp;&amp;</span> <span class="nx">stream</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">videoRef</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">srcObject</span> <span class="o">=</span> <span class="nx">stream</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">newRef</span> <span class="o">=</span> <span class="nx">videoRef</span><span class="p">.</span><span class="nx">current</span><span class="p">;</span>
  <span class="p">(</span><span class="nx">newRef</span> <span class="kd">as </span><span class="kr">any</span><span class="p">).</span><span class="nf">setSinkId</span><span class="p">(</span><span class="nx">userAudioOutputDevice</span><span class="p">?.</span><span class="nx">deviceId</span><span class="p">);</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">stream</span><span class="p">,</span> <span class="nx">videoRef</span><span class="p">,</span> <span class="nx">userAudioOutputDevice</span><span class="p">]);</span>
</code></pre></div></div>

<p>í…Œë§ˆë¡œ ë‚˜ì˜¤ëŠ” ìŒì„±ì„ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Theme.tsx</span>
<span class="nf">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">volumeRef</span><span class="p">.</span><span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">volumeRef</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">volume</span> <span class="o">=</span> <span class="nx">volume</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">newAudio</span> <span class="o">=</span> <span class="nx">volumeRef</span><span class="p">.</span><span class="nx">current</span><span class="p">;</span>
  <span class="p">(</span><span class="nx">newAudio</span> <span class="kd">as </span><span class="kr">any</span><span class="p">).</span><span class="nf">setSinkId</span><span class="p">(</span><span class="nx">userAudioOutputDevice</span><span class="p">?.</span><span class="nx">deviceId</span><span class="p">);</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">volume</span><span class="p">,</span> <span class="nx">userAudioOutputDevice</span><span class="p">]);</span>
</code></pre></div></div>

<p>ì—¬ê¸°ì„œ ìƒˆë¡œ ì¶”ê°€ëœ ë¶€ë¶„ì€ setSinkIdë¥¼ í•´ì£¼ëŠ” ë¶€ë¶„ì´ë‹¤. ë°”ë¡œ deviceIdë¥¼ ë„£ì–´ì£¼ë©´, í•´ë‹¹í•˜ëŠ” deviceë¡œ ì¶œë ¥ì´ ë°”ë€ŒëŠ” ê²ƒì´ë‹¤. userAudioOutputDeviceê°€ ìƒíƒœì´ë¯€ë¡œ, í•´ë‹¹ ìƒíƒœê°€ ë°”ë€”ë•Œ ë§ˆë‹¤ sinkë¥¼ ë§ì¶°ì„œ videoì˜ ì˜¤ë””ì˜¤ë¥¼ ë³€ê²½ í•  ìˆ˜ ìˆê²Œ useEffectë¡œ ê°ì‹¸ì£¼ê³ , dependencyë¡œ ë„£ì–´ì£¼ì—ˆë‹¤.</p>

<p>typeì„ anyë¡œ ë³€ê²½í•´ì¤€ ì´ìœ ëŠ”, ì»´íŒŒì¼ í•  ë•Œ setSinkIdë¥¼ ì°¾ì§€ëª»í•´ ì—ëŸ¬ë¥¼ ë‚´ê¸° ë•Œë¬¸ì´ë‹¤. ì¶”í›„ì— Interfaceë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ setSinkIdë¥¼ ì¶”ê°€í•˜ì—¬ ë°©ì§€í•  ì˜ˆì •ì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë¬¸ì œëŠ” í˜¸í™˜ì„± ë¬¸ì œì´ë‹¤.
<img width="823" alt="image" src="https://user-images.githubusercontent.com/66371206/188821917-ecf262ae-c9d0-449f-a9d6-e3675c879224.png" />
ë³´ì‹œë‹¤ì‹œí”¼, Chrome, IE, Operaë§Œ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•˜ê¸°ì—, ë§Œì•½ Safarië¡œ ì ‘ì†í•œë‹¤ë©´ ë°”ë¡œ ë°±ìƒ‰í™”ë©´ì´ ëœ¨ëŠ”ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ ê²½ìš°ì—ëŠ” browser ê°ì§€ë¥¼ ìš°ì„ í•˜ì—¬, Safariì—ì„œëŠ” í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šë„ë¡ ë°©ì§€í•´ì¤˜ì•¼ëœë‹¤.</p>

<h3 id="ì…ë ¥-ë””ë°”ì´ìŠ¤-ì„¤ì •">ì…ë ¥ ë””ë°”ì´ìŠ¤ ì„¤ì •</h3>

<p>ì…ë ¥ë””ë°”ì´ìŠ¤ëŠ” ìƒê°ë³´ë‹¤ ê¹Œë‹¤ë¡­ë‹¤.</p>

<p>ìš°ì„ , ì „ì†¡í•˜ëŠ” mediaTrackì´ ì´ë¯¸ getUserMediaì—ì„œ audioë¥¼ defaultë¡œ ê°€ì ¸ì™”ì„í…Œë‹ˆ, ì—¬ê¸°ì„œ ë‚´ê°€ ë§ˆìŒëŒ€ë¡œ media ì¥ë¹„ë¥¼ ë°”ê¾¼ë‹¤ê³  í•´ì„œ ë°”ë¡œ ë°”ë€Œì§€ ì•Šì„ ê²ƒì´ë‹¤. ê·¸ë˜ì„œ ìƒê°í•´ë‚¸ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ol>
  <li>ìƒˆë¡œìš´ ì˜¤ë””ì˜¤ íŠ¸ë™ì„ ë§Œë“¤ì–´ë‚¸ë‹¤ (ìƒˆë¡œ ë°”ë€” ì…ë ¥ deviceì¸ íŠ¸ë™)</li>
  <li>í˜„ì¬ ì†¡ì¶œí•˜ê³  ìˆëŠ” ì˜¤ë””ì˜¤ íŠ¸ë™ì„ ì‚­ì œí•œë‹¤</li>
  <li>ë‚´ streamì— ìƒˆë¡œìš´ íŠ¸ë™ì„ ì¶”ê°€í•œë‹¤</li>
  <li>ë³´ë‚´ê³  ìˆëŠ” streamì— audioë¥¼ ì°¾ì•„ ìƒˆë¡œìš´ trackìœ¼ë¡œ êµì²´í•œë‹¤</li>
</ol>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// useCreateMediaStream.tsx</span>
<span class="kd">const</span> <span class="nx">replaceAudioStream</span> <span class="o">=</span> <span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">audioStream</span> <span class="o">=</span> <span class="k">await</span> <span class="nb">navigator</span><span class="p">.</span><span class="nx">mediaDevices</span><span class="p">.</span><span class="nf">getUserMedia</span><span class="p">({</span>
      <span class="na">audio</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">deviceId</span><span class="p">:</span> <span class="nx">userAudioInputDevice</span><span class="p">?.</span><span class="nx">deviceId</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>
    <span class="nx">myStream</span><span class="p">.</span><span class="nx">localStream</span><span class="p">.</span><span class="nf">removeTrack</span><span class="p">(</span><span class="nx">myStream</span><span class="p">.</span><span class="nx">localStream</span><span class="p">.</span><span class="nf">getAudioTracks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nx">myStream</span><span class="p">.</span><span class="nx">localStream</span><span class="p">.</span><span class="nf">addTrack</span><span class="p">(</span><span class="nx">audioStream</span><span class="p">.</span><span class="nf">getAudioTracks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nf">keys</span><span class="p">(</span><span class="nx">pcs</span><span class="p">).</span><span class="nf">forEach</span><span class="p">((</span><span class="nx">pc</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">sender</span> <span class="o">=</span> <span class="nx">pcs</span><span class="p">[</span><span class="nx">pc</span><span class="p">].</span><span class="nf">getSenders</span><span class="p">().</span><span class="nf">find</span><span class="p">((</span><span class="nx">s</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">track</span><span class="p">.</span><span class="nx">kind</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">audio</span><span class="dl">"</span><span class="p">);</span>
      <span class="nx">sender</span><span class="p">.</span><span class="nf">replaceTrack</span><span class="p">(</span><span class="nx">audioStream</span><span class="p">.</span><span class="nf">getAudioTracks</span><span class="p">()[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">});</span>
  <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">failed to change audio stream</span><span class="dl">"</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">stream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MediaStream</span><span class="p">();</span>
    <span class="nf">setUserMediaStream</span><span class="p">(</span><span class="nx">stream</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>ê·¸ë¦¬ê³  ì´ëŸ° ê³¼ì •ì„ useEffectë¡œ ê°ì‹¸ì„œ, userAudioInputì´ ë°”ë€”ë•Œ ë§ˆë‹¤ ì„ ì–¸í•´ì¤€ë‹¤.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// settingModal</span>
<span class="nf">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nf">replaceAudioStream</span><span class="p">();</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">replaceAudioStream</span><span class="p">,</span> <span class="nx">userAudioInputDevice</span><span class="p">]);</span>
</code></pre></div></div>

<p>ë¬´ì‚¬íˆ ë§ˆì¹˜ê³  ë‚˜ë©´ ì…ë ¥ ë²„íŠ¼ì—ì„œ, ì´ì–´í° -&gt; ë§¥ë¶ìœ¼ë¡œ ë°”ê¾¸ì–´ë„ ìŒì„± ì…ë ¥íŠ¸ë™ì´ ì˜ ë°”ë€ŒëŠ”ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://user-images.githubusercontent.com/66371206/188824872-87f9ddaf-9bcc-44fc-955d-f7abe2beb227.gif" alt="ezgif-2-3f5a74b33f" /></p>
:ET